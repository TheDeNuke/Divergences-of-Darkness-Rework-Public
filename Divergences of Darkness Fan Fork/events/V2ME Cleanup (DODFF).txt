#
# V2ME Cleanup 1.0.3 by Bob Bobington and Dr, configured for DoDFF by DeNuke
#
# Features:
#	
#	-Nearly invisible cleanup tag
#	-Zero performance degradation
#	-Immersion will not be ruined, player interaction with cleanup is kept to an absolute minimum
#	-Multiple stability improvements and bug fixes
#	-Easy to customize for new content
#	-Handles backend tasks (i.e. setting govflags, invention flags, etc) on a daily, monthly, or yearly tick, as needed
#	-Handles vassal interactions with one decision instead of hundreds
#	
# Notable bugs addressed:
#
#	-Ghost units and ships of non-existing nations cleaned monthly
#	-Prevent uncivs from gaining colonial states/capitals incorrectly
#	-Prevent countries with slavery outlawed from having bugged slave states
#	-Prevents existing countries from having non-existing overlords
#	-Prevents existing countries from having non-existing vassals (disabled by default, this is intended in some mods)
#
# Upcoming features (TBA):
#	-Permanent fix to craftsmen exploit/bug, without player interaction
#	-Dynamically adressing the liquidity crisis, effectively
#


country_event = {
	id = 477877787
	title = "AI: Daily Cleanup Check"
	desc = "AI: Daily Cleanup Check"
	
	is_triggered_only = yes
	
	option = {
		name = "Checking..."
		
		any_country = {
            limit = {
				exists = yes
                civilized = yes
				has_country_modifier = western_presence
            }
            remove_country_modifier = western_presence
        }
		
		any_country = {
            limit = {
				exists = yes
				is_vassal = no
				has_country_modifier = autonomous_dependency_modifier
            }
            remove_country_modifier = autonomous_dependency_modifier
        }			
		
		#remove sanctions
		any_country = {
			limit = {
				is_disarmed = yes
				has_recently_lost_war = yes
				OR = {
					has_country_modifier = kinda_bad_badboy
					has_country_modifier = bad_badboy
				}
				war = no
			}
			remove_country_modifier = kinda_bad_badboy
            remove_country_modifier = bad_badboy
		}
		
		#abolishing serfdom
		any_country = {
            limit = {
				exists = yes
                any_owned_province = { has_pop_type = serfs }
                NOT = { debt_law = serfdom }
            }
            any_owned = {
                limit = {
                    has_pop_type = serfs
                    has_pop_type = labourers
                }
                any_pop = { limit = { type = serfs } pop_type = labourers money = 1000 }
            }
            any_owned = {
                limit = {
                    has_pop_type = serfs
                    has_pop_type = farmers
                }
                any_pop = { limit = { type = serfs } pop_type = farmers money = 1000 }
            }
            any_owned = {
                limit = {
                    has_pop_type = serfs
                    NOT = { has_pop_type = farmers has_pop_type = labourers }
                }
                any_pop = { limit = { type = serfs } pop_type = farmers money = 1000 }
            }
        }
		
		#updating missing flags
		any_country = {
			limit = {
				exists = yes
				NOT = {
					has_country_flag = existing_country
				}
			}
			set_country_flag = existing_country
			country_event = 60160
		}
		
		any_country = {
			limit = {
				exists = no
				has_country_flag = existing_country
			}
			clr_country_flag = existing_country
		}
		
		#native assimilation cleanup
		#any_country = {
        #    limit = {
		#		exists = yes
        #        has_country_flag = native_assimilation_enacted
        #        NOT = { has_country_modifier = native_assimilation_act_policy }
        #    }
        #    clr_country_flag = native_assimilation_enacted
        #}
		
		#pay owed steamers
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_ammunition value = 5 }
				ammunition = 5
			}
			ammunition = -5
			change_variable = { which = owed_ammunition value = -5 }
		}
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_small_arms value = 5 }
				small_arms = 5
			}
			small_arms = -5
			change_variable = { which = owed_small_arms value = -5 }
		}
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_steamers value = 5 }
				steamer_convoy = 5
			}
			steamer_convoy = -5
			change_variable = { which = owed_steamers value = -5 }
		}
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_artillery value = 5 }
				artillery = 5
			}
			artillery = -5
			change_variable = { which = owed_artillery value = -5 }
		}
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_canned_food value = 5 }
				canned_food = 5
			}
			canned_food = -5
			change_variable = { which = owed_canned_food value = -5 }
		}
		any_country = {
			limit = {
				exists = yes
				check_variable = { which = owed_cash_money value = 1 }
				money = 10000
			}
			money = -10000
			change_variable = { which = owed_cash_money value = -10 }
		}
				
		# Daily Liquidity Fix - Ported from TGC
		any_country = { limit = { civilized = yes NOT = { enlightenment_thought = 1 }}
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.4 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.3 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.2 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 } }

		any_country = { limit = { enlightenment_thought = 1 NOT = { ideological_thought = 1 } }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 0.1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 0.25 } }

		any_country = { limit = { ideological_thought = 1 NOT = { state_n_government = 1 } }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 0.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 0.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 1 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1 } }
			
		any_country = { limit = { state_n_government = 1 NOT = { nationalism_n_imperialism = 1 } }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 1 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.06 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 } }
		
		any_country = { limit = { nationalism_n_imperialism = 1 NOT = { revolution_n_counterrevolution = 1 } }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.07 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 3 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 3 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 3 } }
		
		any_country = { limit = {  revolution_n_counterrevolution = 1 NOT = { mass_politics = 1 } }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 4 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 4 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 4 } }
		
		any_country = { limit = { mass_politics = 1 NOT = { post_colonialism = 1 }} 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 1.5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.05 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 5 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 5 } }
		
		any_country = { limit = { post_colonialism = 1 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 2 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 unemployment = 0.5 type = soldiers type = slaves } } money = 2 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.08 unemployment = 0.5 type = soldiers type = slaves } } money = 7 } 
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.5 everyday_needs = 0.08 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.2 everyday_needs = 0.02 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.15 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 7 }
						any_pop = { limit = { strata = poor NOT = { cash_reserves = 1.1 everyday_needs = 0.01 unemployment = 0.5 type = soldiers type = slaves } } money = 7 } }
		
		#release colonies that weren't annexed (soon to be deprecated, remove later)
		any_country = {
			limit = {
				exists = yes
				is_vassal = yes
				has_country_flag = colony_to_be_annexed_flag
				NOT = { has_country_modifier = colony_to_be_annexed }
				war = no
			}
			clr_country_flag = colony_to_be_annexed_flag
			country_event = 477877788
			neutrality = yes
		}
		
		#new round of dismantlement (soon to be deprecated, remove later)
		any_country = {
			limit = {
				exists = yes
				is_vassal = yes
				has_country_modifier = colony_to_be_annexed
				ai = yes
				OR = {
					any_greater_power = { has_country_modifier = dismantling_country }
					any_neighbor_country = { has_country_modifier = dismantling_country }
				}
				war = no
				NOT = { has_country_modifier = considering_colonial_offer }
			}
			random_list = {
                17 = { overlord = { country_event = 70005 } }
                17 = { overlord = { country_event = { id = 70005 days = 1 } } }
                17 = { overlord = { country_event = { id = 70005 days = 2 } } }
                17 = { overlord = { country_event = { id = 70005 days = 3 } } }
                17 = { overlord = { country_event = { id = 70005 days = 4 } } }
                15 = { overlord = { country_event = { id = 70005 days = 5 } } }
            }
		}
		CLN = { country_event = { id = 477877787 days = 1 } }
	}
}

country_event = {
	id = 477877790
	title = "AI: Monthly Cleanup Check"
	desc = "AI: Monthly Cleanup Check"
	
	is_triggered_only = yes
	
	option = {
		name = "Checking..."
		
		#clean up crisis tension
		any_country = {
            limit = {
				exists = yes
                OR = {
                    NOT = { has_global_flag = revolution_n_counter_researched }
                    is_vassal = yes
                }
            }
            any_state  = { flashpoint_tension = -100 }
        }
		#make CLN unable to be interacted with by ai
		any_country = {
			limit = {
				exists = yes
			}
			relation = { who = THIS value = -400 }
		}
		
		#silver mine modifiers
		any_country = {
			limit = {
				any_owned_province = {
					OR = {
						province_id = 2158
						province_id = 2322
						province_id = 2323
						province_id = 2296
						province_id = 312
						province_id = 2283
						province_id = 2294
						province_id = 2293
						province_id = 2299
						province_id = 2304
					}
					trade_goods = precious_metal
					NOT = { has_province_modifier = silver_mine }
				}
			}
			any_owned = {
				limit = {
					OR = {
						province_id = 2158
						province_id = 2322
						province_id = 2323
						province_id = 2296
						province_id = 312
						province_id = 2283
						province_id = 2294
						province_id = 2293
						province_id = 2299
						province_id = 2304
					}
					trade_goods = precious_metal
					NOT = { has_province_modifier = silver_mine }
				}
				add_province_modifier = { name = silver_mine duration = -1 }
			}
		}

		any_country = {
			limit = {
				any_owned_province = {
					has_province_modifier = silver_mine
			    }
			}
			any_owned = {
				limit = {
				    has_province_modifier = silver_mine
					NOT = { trade_goods = precious_metal }
				}
				remove_province_modifier = silver_mine
			}
		}
		
		#stop vassal payments
		any_country = {
			limit = {
				exists = yes
				is_vassal = yes
				overlord = { has_country_flag = vassals_dont_need_to_pay }
			}
			set_country_flag = exempt_from_vassal_contribution
		}
		
		#cleanup colonial cores
		any_country = {
			limit = {
				civilized = yes
				NOT = {
					capital_scope = { continent = africa }
				}
			    }
				any_owned = {
					limit = {
						is_core = NGR
						OR = {
							is_core = SOK
							is_core = ILO
							is_core = TOU
							is_core = OYO
							is_core = KNO
							is_core = ADW
							is_core = NRI
							is_core = KAN
						}
					}
					remove_core = SOK
					remove_core = ILO
					remove_core = TOU
					remove_core = OYO
					remove_core = KNO
					remove_core = ADW
					remove_core = NRI
					remove_core = KAN
				}
				any_owned = {
					limit = {
						is_core = CMR
						OR = {
							is_core = SOK
							is_core = ADW
							is_core = NRI
							is_core = KAN
						}
					}
					remove_core = SOK
					remove_core = ADW
					remove_core = NRI
					remove_core = KAN
				}
				any_owned = {
					limit = {
						is_core = CAR
						OR = {
							is_core = KAN
							is_core = ADW
							is_core = WTT	
						}
					}
					remove_core = KAN
					remove_core = ADW
					remove_core = WTT   					
				}
				any_owned = {
					limit = {
						is_core = IVC
						OR = {
							is_core = ASH
							is_core = WTT
						}
					}	
					remove_core = ASH
					remove_core = MOS
					remove_core = WTT
				}
				any_owned = {
					limit = {
						is_core = GNE
						OR = {
							is_core = FJA
							is_core = WTT
						}
					}
					remove_core = FJA
					remove_core = WTT
				}
				any_owned = {
					limit = {
						is_core = SNG
						OR = {
							is_core = FJA
							is_core = TOU
						}
					}
					remove_core = FJA
					remove_core = TOU
				}
				any_owned = {
					limit = {
						is_core = NIG
						OR = {
							is_core = ILO
							is_core = TOU
							is_core = KNO
							is_core = KAN
							is_core = SOK
						}
					}
					remove_core = SOK
					remove_core = ILO
					remove_core = TOU	
					remove_core = KNO
					remove_core = KAN
				}
				any_owned = {
					limit = {
					    OR = {
						  is_core = CNG
						  is_core = CGO
						}
						OR = {			
						  is_core = LOA	
						  is_core = KON					        
						}
					}					
					remove_core = LOA
					remove_core = KON                 
				}
				any_owned = {
					limit = {
						is_core = MAL
						OR = {
							is_core = TOU
							is_core = FJA	
							is_core = ILO
							
						}
					}
					remove_core = TOU
					remove_core = FJA	
					remove_core = MOS
					remove_core = ILO
					
				}
				any_owned = {
					limit = {
						is_core = GMB
						OR = {
							is_core = FJA	
							is_core = TOU
						}
					}
					remove_core = FJA	
					remove_core = TOU
				}
				any_owned = {
					limit = {
						is_core = MOZ
						OR = {
							is_core = ZUL
							is_core = SHO
						}
					}	
					remove_core = ZUL
					remove_core = SHO
				}
				any_owned = {
					limit = {
						is_core = ALD
						OR = {
							is_core = ALJ
							is_core = KBL
						}
					}
					remove_core = KBL
					remove_core = ALJ
				}
				any_owned = {
					limit = {
						is_core = TRA
						OR = {
							is_core = MYS
							is_core = MDR
							is_core = ADR
							is_core = HYD
							}
						}
					remove_core = MYS
					remove_core = MDR
					remove_core = ADR
					remove_core = HYD
				}
				any_owned = {
					limit = {
						is_core = PAK
						OR = {
							is_core = SIN
							is_core = KAS
							is_core = JOD
							is_core = MEW
							is_core = JAI
							is_core = JAS
							is_core = BIK				
							}
						}
					remove_core = SIN
					remove_core = KAS
					remove_core = JOD
					remove_core = MEW
					remove_core = JAI
					remove_core = JAS
					remove_core = BIK
				}
				any_owned = {
					limit = {
						is_core = MUG
						OR = {
							is_core = KAS
							is_core = BUN
							is_core = AWA
							is_core = BIH
							is_core = GWA
							is_core = ORI
							is_core = NAG
						}
					}
					remove_core = KAS
					remove_core = BUN
					remove_core = AWA
					remove_core = BIH
					remove_core = GWA
					remove_core = ORI
					remove_core = NAG
				}
				any_owned = {
					limit = {
						is_core = RAJ
						OR = {
							is_core = JOD
							is_core = MEW
							is_core = JAI
							is_core = JAS
							is_core = BIK
							is_core = BER
						}
					}
					remove_core = JOD
					remove_core = MEW
					remove_core = JAI
					remove_core = JAS
					remove_core = BIK
					remove_core = BER
				}
		}
		
		# Landlocked Cleanup
		any_country = {
			limit = {
			   exists = yes
               NOT = { any_owned_province = { port = yes } }
			}
			add_country_modifier = { name = landlocked_nation duration = -1 }
		}
		any_country = {
			limit = {
			   exists = yes
			   has_country_modifier = landlocked_nation 
               any_owned_province = { port = yes }
			}
			remove_country_modifier = landlocked_nation
		}
		
		#fix for bad modifier
		any_country = {
			limit = {
				ai = no
				war = no
				has_country_modifier = disable_conquest_cb
			}
			remove_country_modifier = disable_conquest_cb
		}
		
		#Remove call_allies flag
		any_country = {
			limit = {
				ai = yes
				war = no
				has_country_flag = calling_all_allies
			}
			clr_country_flag = calling_all_allies
		}
		
		#cleanup unciv colonies
		any_country = {
			limit = {
				civilized = no
				any_state = { is_colonial = yes }
				NOT = {
					UTI = { exists = yes }
				}
			}
			any_state = {
				limit = {
					is_colonial = yes
				}
				any_owned = {
					add_core = UTI
				}
			}
			any_owned = {
				limit = {
					is_core = UTI
				}
				secede_province = THIS
			}
			THIS = {
				any_owned = {
					limit = {
						is_core = UTI
					}
					secede_province = UTI
				}
				create_vassal = UTI
			}
			inherit = UTI
			any_owned = {
				limit = {
					is_core = UTI
				}
				remove_core = UTI
			}
		}
		
		#cleanup bugged slave states
		any_country = {
			limit = {
				any_state = { is_slave = yes }
				slavery = no_slavery
			}
			any_state = {
				limit = {
					is_slave = yes
				}
				is_slave = no
			}
		}
		
		#cleanup vassals with nonexistent overlords
		any_country = {
			limit = {
				is_vassal = yes
				exists = yes
				overlord = { exists = no }
			}
			country_event = 477877788
		}
		
		#cleanup overlords with nonexistent vassals - disabled by default
		#any_country = {
		#	limit = {
		#		is_vassal = yes
		#		exists = no
		#		overlord = { exists = yes }
		#	}
		#	country_event = 477877788
		#}			
		
		#cleanup bad govflags
		any_country = {
			limit = {
				OR = {
					AND = {
						government = theocracy
						NOT = { has_country_flag = theocratic_government }
					}
					AND = {
						government = proletarian_dictatorship
						NOT = { has_country_flag = communist_gov }
					}
					AND = {
						government = absolute_monarchy
						NOT = { has_country_flag = absolute_monarchy_gov }
					}
					AND = {
						government = prussian_constitutionalism
						NOT = { has_country_flag = semi_constitutional_monarchy_gov }
					}
					AND = {
						government = hms_government
						NOT = { has_country_flag = constitutional_monarchy_gov }
					}
					AND = {
						government = presidential_dictatorship
						NOT = { has_country_flag = presidential_dictatorship_gov }
					}
					AND = {
						government = fascist_dictatorship
						NOT = { has_country_flag = fascist_gov }
					}
					AND = {
						government = bourgeois_dictatorship
						NOT = { has_country_flag = anarcho_liberal_gov }
					}
					AND = {
						government = democracy
						NOT = { has_country_flag = democracy_gov }
					}
					AND = {
						government = fascist_monarchy
						NOT = { has_country_flag = fascist_monarchy_gov }
					}
					AND = {
						government = socialist_republic
						NOT = { has_country_flag = socialist_republic_gov }
					}
					AND = {
						government = parliamentary_republic
						NOT = { has_country_flag = parliamentary_republic_gov }
					}
					AND = {
						government = autonomous_dependency
						NOT = { has_country_flag = autoden_gov }
					}
				}
			}
			clr_country_flag = theocratic_government
			clr_country_flag = communist_gov
			clr_country_flag = absolute_monarchy_gov
			clr_country_flag = semi_constitutional_monarchy_gov
			clr_country_flag = constitutional_monarchy_gov
			clr_country_flag = presidential_dictatorship_gov
			clr_country_flag = fascist_gov
			clr_country_flag = anarcho_liberal_gov
			clr_country_flag = democracy_gov
			clr_country_flag = fascist_monarchy_gov
			clr_country_flag = socialist_republic_gov
			clr_country_flag = parliamentary_republic_gov
			clr_country_flag = autoden_gov
			random_owned = {
				limit = {
					owner = {
						government = theocracy
					}
				}
				owner = { set_country_flag = theocratic_government }
			}
			random_owned = {
				limit = {
					owner = {
						government = proletarian_dictatorship
					}
				}
				owner = { set_country_flag = communist_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = absolute_monarchy
					}
				}
				owner = { set_country_flag = absolute_monarchy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = prussian_constitutionalism
					}
				}
				owner = { set_country_flag = semi_constitutional_monarchy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = hms_government
					}
				}
				owner = { set_country_flag = constitutional_monarchy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = presidential_dictatorship
					}
				}
				owner = { set_country_flag = presidential_dictatorship_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = fascist_dictatorship
					}
				}
				owner = { set_country_flag = fascist_monarchy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = democracy
					}
				}
				owner = { set_country_flag = democracy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = bourgeois_dictatorship
					}
				}
				owner = { set_country_flag = anarcho_liberal_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = fascist_monarchy
					}
				}
				owner = { set_country_flag = fascist_monarchy_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = socialist_republic
					}
				}
				owner = { set_country_flag = socialist_republic_gov }
			}
			random_owned = {
				limit = {
					owner = {
						government = parliamentary_republic
					}
				}
				owner = { set_country_flag = parliamentary_republic_gov  }
			}
			random_owned = {
				limit = {
					owner = {
						government = autonomous_dependency
					}
				}
				owner = { set_country_flag = autoden_gov }
			}
		}
		
		#updating flags for techs/inventions
		any_country = {
			limit = {
				medicine = 1
				NOT = { has_country_flag = medicine_invented }
			}
			set_country_flag = medicine_invented
		}
		any_country = {
			limit = {
				organic_chemistry = 1
				NOT = { has_country_flag = organic_invented }
			}
			set_country_flag = organic_invented
		}
		any_country = {
			limit = {
				inorganic_chemistry = 1
				NOT = { has_country_flag = inorganic_chemistry_invented }
			}
			set_country_flag = inorganic_chemistry_invented
		}
		any_country = {
			limit = {
				biologism = 1
				NOT = { has_country_flag = biologism_invented }
			}
			set_country_flag = biologism_invented
		}
		any_country = {
			limit = {
				invention = sanitation
				NOT = { has_country_flag = sanitation_invented }
			}
			set_country_flag = sanitation_invented
		}
		any_country = {
			limit = {
				invention = germ_theory
				NOT = { has_country_flag = germs_invented }
			}
			set_country_flag = germs_invented
		}
		any_country = {
			limit = {
				invention = eugenics
				NOT = { has_country_flag = eugenics_invented }
			}
			set_country_flag = eugenics_invented
		}
		any_country = {
			limit = {
				invention = great_war_paradigm
				NOT = { has_country_flag = GWP_invented }
			}
			set_country_flag = GWP_invented
		}
		any_country = {
			limit = {
				electricity = 1
				NOT = { has_country_flag = electricity_invented }
			}
			set_country_flag = electricity_invented
		}
		any_country = {
			limit = {
				modern_central_bank_system = 1
				NOT = { has_country_flag = modern_central_bank_system_invented }
			}
			set_country_flag = modern_central_bank_system_invented
		}
		
		#adding immigration modifiers with particular techs
		any_country = {
			limit = {
				experimental_psychology = 1
			    OR = { 
				   continent = north_america
				   continent = south_america
				   continent = oceania
				   tag = SAF
				   primary_culture = boer
			    }
				NOT = { has_country_modifier = citizenship_tests }
			}
			add_country_modifier = {
				name = citizenship_tests
				duration = -1
			}
		}
		any_country = {
			limit = {
				state_n_government = 1
			    OR = { 
				   continent = north_america
				   continent = south_america
				   continent = oceania
				   tag = SAF
				   primary_culture = boer
			    }
				NOT = { has_country_modifier = passports }
			}
			add_country_modifier = {
				name = passports
				duration = -1
			}
		}
		any_country = {
			limit = {
				nationalism_n_imperialism = 1
			    OR = { 
				   continent = north_america
				   continent = south_america
				   continent = oceania
				   tag = SAF
				   primary_culture = boer
			    }
				NOT = { has_country_modifier = the_open_door }
			}
			add_country_modifier = {
				name = the_open_door
				duration = -1
			}
		}
		
		#enabling crisis
		random_country = {
			limit = {
				exists = yes
				NOT = { has_global_flag = revolution_n_counter_researched }
				revolution_n_counterrevolution = 1
			}
			set_global_flag = revolution_n_counter_researched
		}
		
		# Levys are dead jim
		any_country = {
			limit = {
			    NOT = { has_country_flag = levys_abolished }
				NOT = { recruitment_reform = peasant_levys }
			}
			set_country_flag = levys_abolished
		}
		
		# Delete Illegal Soldier Pops
		
		any_country = {
			limit = {
				OR = {
					recruitment_reform = peasant_levys
					recruitment_reform = restricted_recruitment
				}
			}
            any_owned = {
                   limit = {
                      has_pop_type = soldiers
                      has_pop_type = labourers
					  is_colonial = no
                   }
                   any_pop = { limit = { NOT = { is_accepted_culture = yes is_primary_culture = yes } type = soldiers } militancy = 1 pop_type = labourers  }
            }
            any_owned = {
                   limit = {
                       has_pop_type = soldiers
                       has_pop_type = farmers
					   is_colonial = no
                   }
                   any_pop = { limit = { NOT = { is_accepted_culture = yes is_primary_culture = yes } type = soldiers } militancy = 1 pop_type = farmers }
            }
            any_owned = {
                    limit = {
                       has_pop_type = soldiers
                       NOT = { has_pop_type = farmers has_pop_type = labourers }
					   is_colonial = no
                    }
                    any_pop = { limit = { NOT = { is_accepted_culture = yes is_primary_culture = yes } type = soldiers } militancy = 1 pop_type = farmers }
            }
		}

		#If Tuscan global flag has not been cleared and its 1850 then clear it
		any_country = {
			limit = {
				has_global_flag = TUS_carbonari
				year = 1850
			}
			clr_global_flag = TUS_carbonari
		}
		
		#ghost units monthly cleanup
		any_country = {
			limit = {
				exists = no
                is_greater_power = no
                #has_country_flag = existing_country
                capital_scope = { NOT = { province_control_days = 120 } }
                OR = {
                    is_mobilised = yes
                    total_amount_of_ships = 1
                }
			}
			annex_to = FROM
		}
		
		CLN = { country_event = { id = 477877790 days = 30 } }
	}
}

country_event = {
	id = 477877791
	title = "AI: Yearly Cleanup Check"
	desc = "AI: Yearly Cleanup Check"
	
	is_triggered_only = yes
	
	option = {
		name = "Checking..."
		
		# Colonial Mait - Pre-Post Colonial
		
		any_country = {
		    limit = {
			   ai = yes
			   exists = yes
			   NOT = { has_global_flag = post_colonial_era_fired }
			}
			any_country = {
				any_owned = {
					limit = {
						is_colonial = yes
					}
					add_province_modifier = {
						name = colonial_province
						duration = -1
					}
				}
			}
			any_country = {
				any_owned = {
					limit = {
						owner = { invention = colonial_exploitation }
						is_colonial = yes
					}
					add_province_modifier = {
						name = colonial_exploitation_tech_effect
						duration = -1
					}
				}
			}
			any_country = {
				any_owned = {
					limit = {
						is_colonial = no
					}
					remove_province_modifier = colonial_province
					remove_province_modifier = colonial_exploitation_tech_effect
				}
			}
			any_country = {
				limit = {
					ai = yes
				}
				add_country_modifier = {
					name = ai_nation_boost_income
					duration = -1
				}
			}
			any_country = {
				limit = {
					not = { ai = yes }
				}
				remove_country_modifier = ai_nation_boost_income
			}		
		}
		
		# Colonial Mait - Post Colonial
		
		any_country = {
		    limit = {
			   ai = yes
			   exists = yes
			   has_global_flag = post_colonial_era_fired
			}
			any_country = {
				any_owned = {
					limit = {
						has_province_modifier = colonial_province
					}
                    remove_province_modifier = colonial_province
				}
			}
		    any_country = {
			   limit = {
				   NOT = { capital_scope = { continent = africa } }
			   }
			   any_owned = {
				   limit = {
					   is_colonial = yes
					   continent = africa
				   }
				   add_province_modifier = {
					  name = colonial_dawn
					  duration = -1
				   }
			   }
		   }
		   any_country = {
			   limit = {
				   NOT = { capital_scope = { continent = asia } }
			   }
			   any_owned = {
				   limit = {
					   is_colonial = yes
					   continent = asia
					   NOT = { is_core = RUS }						   
				   }
				   add_province_modifier = {
					   name = colonial_dawn
					   duration = -1
				   }
			   }
		   }
		   any_country = {
			   limit = {
				   is_vassal = yes
				   capital_scope = { continent = africa }
			   }
			   any_owned = {
			   	   limit = {
					   continent = africa
				   }
				   add_province_modifier = {
					   name = colonial_dawn
					   duration = -1
				   }
			   }
		   }
		   any_country = {
		 	   limit = {
				   is_vassal = yes
				   capital_scope = { continent = asia }
			   }
			   any_owned = {
				    limit = {
					   continent = asia
					   NOT = { is_core = RUS }	
				   }
				   add_province_modifier = {
					   name = colonial_dawn
					   duration = -1
				   }
			   }
		   }
		   any_country = {
			   any_owned = {
				   limit = {
					   owner = { invention = colonial_exploitation }
					   is_colonial = yes
					   NOT = { is_core = RUS }	
				   }
				   add_province_modifier = {
					   name = colonial_exploitation_tech_effect
					   duration = -1
				   }
			   }
		   }
		   any_country = {
				any_owned = {
					limit = {
					    OR = {
						   is_colonial = no
						   is_core = RUS 
						}	
					}
					remove_province_modifier = colonial_province
					remove_province_modifier = colonial_exploitation_tech_effect
					remove_province_modifier = colonial_dawn
				}
		   }
		   any_country = {
			   limit = {
				   ai = yes
				   exists = yes
				   NOT = { has_country_modifier = ai_nation_boost_income }
			   }
			   add_country_modifier = {
				   name = ai_nation_boost_income
				   duration = -1
			   }
		   }
		   any_country = {
			   limit = {
				   ai = no
				   has_country_modifier = ai_nation_boost_income
			   }
			   remove_country_modifier = ai_nation_boost_income
		   }
		}
		
		#slave pop growth
		any_country = {
            limit = {
				exists = yes
                NOT = { has_country_modifier = slave_growth }
                slavery = yes_slavery
                any_owned_province = { has_pop_type = slaves NOT = { slaves = 0.75 } }
            }
            any_pop = {
                limit = { type = slaves NOT = { location = { slaves = 0.75 } } }
                random_list = {
                    10 = {}
                    10 = { reduce_pop = 1.04 }
                    10 = { reduce_pop = 1.05 }
                    10 = { reduce_pop = 1.06 }
                    10 = { reduce_pop = 1.07 }
                    10 = { reduce_pop = 1.08 }
                    10 = { reduce_pop = 1.09 }
                    10 = { reduce_pop = 1.10 }
                    10 = { reduce_pop = 1.11 }
                    10 = { reduce_pop = 1.12 }
                }
            }
            any_pop = {
                limit = { type = slaves }
                random = { chance = 10 reduce_pop = 0.97 }
            }
            any_pop = {
                limit = { type = slaves }
                random = { chance = 10 reduce_pop = 0.98 }
            }
            random_list = {
                33 = { add_country_modifier = { name = slave_growth duration = 1460 } }
                33 = { add_country_modifier = { name = slave_growth duration = 1827 } }
                33 = { add_country_modifier = { name = slave_growth duration = 2190 } }
            }
            any_pop = { limit = { type = slaves } literacy = -0.1 }
        }
		
		#substate payment
		any_country = {
			limit = {
				exists = yes
				OR = {
					is_substate = yes
					AND = {
						is_vassal = yes
						is_substate = no
						total_pops = 250000
					}
				}
				NOT = { has_country_flag = exempt_from_vassal_contribution }
				NOT = { has_country_modifier = monthly_payment_made }
			}
			random_owned = {
				limit = {
					owner = {
						money = 1500
						NOT = { total_pops = 750000 }
					}
				}
				owner = {
					treasury = -1500
					overlord = { treasury = 1500 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 2500
						total_pops = 750000
						NOT = { total_pops = 1000000 }
					}
				}
				owner = {
					treasury = -2500
					overlord = { treasury = 2500 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 3000
						total_pops = 1000000
						NOT = { total_pops = 1250000 }
					}
				}
				owner = {
					treasury = -3000
					overlord = { treasury = 3000 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 3500
						total_pops = 1250000
						NOT = { total_pops = 1500000 }
					}
				}
				owner = {
					treasury = -3500
					overlord = { treasury = 3500 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 4000
						total_pops = 1500000
						NOT = { total_pops = 1750000 }
					}
				}
				owner = {
					treasury = -4000
					overlord = { treasury = 4000 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 4500
						total_pops = 1750000
						NOT = { total_pops = 2000000 }
					}
				}
				owner = {
					treasury = -4500
					overlord = { treasury = 4500 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 5000
						total_pops = 2000000
						NOT = { total_pops = 2250000 }
					}
				}
				owner = {
					treasury = -5000
					overlord = { treasury = 5000 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 5500
						total_pops = 2250000
						NOT = { total_pops = 2500000 }
					}
				}
				owner = {
					treasury = -5500
					overlord = { treasury = 5500 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
			random_owned = {
				limit = {
					owner = {
						money = 6000
						total_pops = 2500000
					}
				}
				owner = {
					treasury = -6000
					overlord = { treasury = 6000 }
					add_country_modifier = { name = monthly_payment_made duration = 365 }
				}
			}
		}
		
		#upgrade rebels
		random_owned = {
			limit = {
				owner = {
					year = 1850
					NOT = { has_global_flag = rebel_tech_1850 }
					NOT = { has_global_flag = disable_rebel_improvement }
				}
			}
			owner = {
				REB = {
					activate_technology = flintlock_rifles
				}
				set_global_flag = rebel_tech_1850
			}
		}
		random_owned = {
			limit = {
				owner = {
					year = 1865
					NOT = { has_global_flag = rebel_tech_1865 }
					NOT = { has_global_flag = disable_rebel_improvement }
				}
			}
			owner = {
				REB = {
				    activate_technology = muzzle_loaded_rifles	

				}
				set_global_flag = rebel_tech_1865
			}
		}
		random_owned = {
			limit = {
				owner = {
					year = 1880
					NOT = { has_global_flag = rebel_tech_1880 }
				}
			}
			owner = {
				set_global_flag = rebel_tech_1880
				REB = {
				    activate_technology = breech_loaded_rifles	
					activate_technology = post_napoleonic_thought				
					activate_technology = bronze_muzzle_loaded_artillery
					activate_technology = military_staff_system
					activate_technology = army_command_principle
				}
			}
		}
		random_owned = {
			limit = {
				owner = {
					year = 1900
					NOT = { has_global_flag = rebel_tech_1900 }
				}
			}
			owner = {
				set_global_flag = rebel_tech_1900
				REB = {
				    activate_technology = machine_guns
					activate_technology = strategic_mobility									
					activate_technology = iron_muzzle_loaded_artillery
					activate_technology = military_plans
					activate_technology = army_professionalism
				}
			}
		}
		random_owned = {
			limit = {
				owner = {
					year = 1920
					NOT = { has_global_flag = rebel_tech_1920 }
				}
			}
			owner = {
				set_global_flag = rebel_tech_1920
				REB = {
				   activate_technology = bolt_action_rifles
				   activate_technology = point_defense_system				    				
				   activate_technology = iron_breech_loaded_artillery
				   activate_technology = military_statistics 
				   activate_technology = army_decision_making
				}
			}
		}		
		CLN = { country_event = { id = 477877791 days = 365 } }
	}
}

country_event = {
	id = 477877788
	title = "Freedom!"
	desc = "We have acquired independence!"
	
	is_triggered_only = yes
	
	option = {
		name = "Nice."
		overlord = { diplomatic_influence = { who = THIS value = -200 } release_vassal = THIS }
	}
}

country_event = {
	id = 477877789
	title = "AI: Cleanup Setup"
	desc = "AI: Cleanup Setup"
	
	is_triggered_only = yes
	
	option = {
		name = "Cleanup Setup"
		CLN = {
			country_event = 477877787
			country_event = 477877790
			country_event = 477877791
			add_country_modifier = { name = neutrality duration = -1 }
		}
	}
}

#End war with non-existent nations
country_event = {
    id = 1412204
    title = "End War with non-existent nation"
    desc = "As the country no longer exists, the war has ceased."
    picture = "clear_non_existent"
    is_triggered_only = yes
    option = {
        name = "Good"
        end_war = FROM
    }
}

##vassal interactions events

country_event = {
	id = 477877792
	title = "Vassal Interactions: $FROMCOUNTRY$"
	desc = "If $FROMCOUNTRY$ is the country you want to interact with, select an option. Otherwise, select 'Next country' to cycle through, or select 'Exit options' to return to the game."
	
	is_triggered_only = yes
	
	option = {
		name = "Release this country"
		random_owned = { limit = { owner = { NOT = { prestige = 200 } } } owner = { prestige_factor = -0.05 } }
		random_owned = { limit = { owner = { prestige = 200 } } owner = { prestige = -10 } }	
		FROM = {
			country_event = 477877788
		}
		any_country = {
			limit = {
				exists = yes
				vassal_of = THIS
			}
			clr_country_flag = interacted_with
		}
	}
	
	option = {
		name = "Return cores to this country"
		any_owned = {
			limit = {
				is_core = FROM
				NOT = { is_core = THIS }
			}
			secede_province = FROM
		}
		any_country = {
			limit = {
				exists = yes
				vassal_of = THIS
			}
			clr_country_flag = interacted_with
		}
	}
	
	option = {
		name = "Next country"
		random_country = {
			limit = {
				vassal_of = THIS
				exists = yes
				NOT = { has_country_flag = interacted_with }
			}
			country_event = 477877793
			THIS = { set_country_flag = possible_interactions }
		}
		any_country = {
			limit = {
				vassal_of = THIS
				exists = yes
				THIS = { NOT = { has_country_flag = possible_interactions } }
			}
			clr_country_flag = interacted_with
		}
	}
	
	option = {
		name = "Exit options"
		any_country = {
			limit = {
				exists = yes
				vassal_of = THIS
			}
			clr_country_flag = interacted_with
		}
	}
}

country_event = {
	id = 477877793
	title = "AI: Vassal Interactions"
	desc = "This event lets your overlord interact with you. If you are a player, just close this."
	
	is_triggered_only = yes
	
	option = {
		name = "OK"
		set_country_flag = interacted_with
		FROM = { clr_country_flag = possible_interactions }
		overlord = { country_event = 477877792 }
	}
}

